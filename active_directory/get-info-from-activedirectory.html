<!doctype html>
<html lang='en'>
<head>
<meta charset='utf-8' name='viewport' content='width=device-width, initial-scale=1.0'>
<title>get-info-from-activedirectory . Today I Learned (secretGeek)</title>
<script type="text/javascript" src="/highlight.pack.js" defer></script>
<script type="text/javascript" src="/script.js" defer></script>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’¡</text></svg>">
</head>
<body>
<link rel="stylesheet" type="text/css" href="/highlight.min.css">
<link rel="stylesheet" type="text/css" href="/dracula.css">
<link rel="stylesheet" type="text/css" href="/style.css">
<header>
<div class='nav'><a href='/'>ðŸ’¡ Today I Learned</a>
<form action="https://www.google.com/search" method="get" class='search'>
<input type="hidden" value="til.secretgeek.net" name="as_sitesearch">
<input type="submit" value="ðŸ”Ž" class="search-button" name="btnG" title="Search" style="float:right">
<input type="text" maxlength="255" size="20" name="q" class="search-text" placeholder="Search..." style="float:right">
</form>
</div>
</header>
<div id='breadcrumb' class='breadcrumb'>*</div>
<article>
<h1 id="how-to-get-info-from-active-directory">How to get info from active directory</h1>
<h2 id="look-for-a-user-or-group">Look for a user or group</h2>
<p>This works on most windows machines (if they are connected to a domain):</p>
<pre><code>Rundll32 dsquery.dll OpenQueryWindow
</code></pre>
<p>...brings up a tool that lets you search for users or groups. It does not tell you very much about the user or group, but you can see which users and groups are in a group.</p>
<h2 id="find-out-information-about-yourself">Find out information about yourself</h2>
<p>The Group Policy Result tool tells you interesting things, even if you're not connected to a domain.</p>
<pre><code>gpresult /v
</code></pre>
<p>...including which groups you are a member of.</p>
<h2 id="find-your-logon-server">Find your logon server</h2>
<p>In powershell:</p>
<pre><code>echo $env:LOGONSERVER
</code></pre>
<p>(or in <code>cmd.exe</code> use <code>echo %LOGONSERVER%</code>)</p>
<h2 id="use-sysinternals-tools">Use Sysinternals tools</h2>
<p><a href="https://docs.microsoft.com/en-gb/sysinternals/downloads/adexplorer">ADExplorer from sysinternals</a> is a comprehensive tool for exploring the Active Directory environment.</p>
<p>You can use all of their tools without manually downloading them by using:</p>
<pre><code>net use * \\live.sysinternals.com\tools\
</code></pre>
<p>...to create a local drive (e.g. <code>z:</code> from which you can access all their tools.</p>
<h2 id="remote-server-administration-tools">Remote Server Administration Tools</h2>
<p>If possible though, I prefer to use <code>RSAT</code> (a name it is best not to say out loud) which includes 147 powerful powershell <code>Cmdlet</code>s in an <code>ActiveDirectory</code> module. I mostly use <a href="../powershell/get_aduser.html"><code>Get-ADUser</code></a> and <a href="get-adgroup.html"><code>Get-ADGoup</code></a>.</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="get-adgroup.html">Get-AdGroup in powershell via RSAT (Remote server administration tools)</a></li>
<li><a href="../powershell/get_aduser.html">Powershell: get-aduser is useful to get info about a user account</a></li>
<li><a href="../powershell/password_complexity.html">How to determine password complexity rules (from powershell)</a> â€” uses Get-ADDefaultDomainPasswordPolicy</li>
</ul>

</article>
<footer><hr /><small><a href='http://secretgeek.net'>secretgeek.net</a> | <a href='https://nimbletext.com'>nimbletext</a> | <a href='http://timesnapper.com'>TimeSnapper</a>|  <a rel='me' href='https://mastodon.cloud/@secretgeek' title='@secretgeek on mastodon'>@secretgeek</a> </small><br /><br /></footer>
</body>
</html>